import{_ as q,u as P,r as _,e as E,w as W,a as v,b as a,d as s,f as A,g as d,t as c,n as X,h as V,v as S,i as r,j as u,o as g,k as Y,M as p,s as Z}from"./index-DX48FY35.js";const $="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAAXNSR0IArs4c6QAAAC1QTFRFR3BMbW5hbnBhbnBibnBibnBib3BjbnBj////6+vp0NHMuLmyn6CXhIZ6b3Fjb4LxRQAAAAh0Uk5TAB9Idp2+1uxN3AVBAAADB0lEQVR42sWbW5bkIAhABRXji/0vdz56zjinu8siFoS7AQivkADhCMAYU85UCnMplHOKESE8AmAifgElay1wCd8oYSe9sIhioQMs6RJKhKAJZr5NRj3xxEcQKot3sQJk/ogE4SMSf0wK52BhBQgVHt/DCECsRgYf8y8KOpl/EcMtMquTnNy/yOArX64BFDaCQCrfUwMgNiSL5LtqkNmYpFB/DCtS5AfATQDwExQIryj8CFkQAC5hgPwYsK+A9pCTAxZx4wCvTCB+lCQoQbagjwEW2dYAc44xJu9Auxo4Wr2+aFNoAtSUfv1HHbJqRGri6/WNKUkEVBe/aJJakFiD2a5fqIJyCKxBv36HX0KaOTjr9QJBJmaDx1/wWx+ArvflMcBleUDb/IvOG0AlB8a1Y7xvC4qO++UeWGSFKtSuLZ23fB4C9dpSBV1B1g+/RRf0hsVQfhV0ZmAo/5qC/hwN5Q9+SwjRTn7n9+B5GVKRz3icBE1gfwExkI38OllEOszCLjC/pQJj//R9spQc+IC5FT/4BhTUE6CzuQJNUP2klKAdAI3vEXQCYDHNFagq+bdcUJQ7MGsFhrD+yhUgTQcMvguFrJiBnW+TQ7L4BJCT7ilQ1UrwUiAqOaBNPiEGvOmAqvH4CwxwzwGVZ/+hQxt8CgR5Iej/Ku0crf7VorY++Jxy48to/ki0OafG/9J0IwKrxW97vBGBw+KXNcg/Q6rN7IbEJaDbjG6SuAZPm8kNimuw1dSiCLuQxsqU8EUStoHdanCEwpdgN5sbFVkXMMzGl0nWhw+z6SXIuoBhN0HOojas280uUdSGdcPRJQnasDYNJ5f41gF12s5uae+AOliZLJzeL+8rg8INpracr0oSr/DMMR9a5YlOKxyL4rM84L/G47/ItCAHBzgts/mv8/kvNPqvdLoEov9aLbkvNnuvdvsutxM4r/d7Hzh4n3h4H7m4n/kcAMnB/A6nXuaxGL3P/XwPHiFoEOnU+c5Hr85nv76Hz56n3xGDKRBfKlGyyvG7/PyfNM7//wCJVZyhBTjJegAAAABJRU5ErkJggg==",ee={class:"home-container"},ae={class:"content"},le={id:"section_submit",class:"content-section"},te={class:"section-content wide"},oe={class:"form_area"},se={class:"form_group"},ne={class:"form_left"},re={class:"form_item"},ie={key:0,class:"error_message"},ue={class:"form_item"},me={key:0,class:"error_message"},ve={class:"form_right"},de={class:"form_item"},ce={class:"uploaded-image-preview"},ge=["src"],pe={class:"upload-button-wrapper"},fe={class:"upload-actions"},_e={key:0,class:"error_message"},Ae={class:"form_item"},Ce={key:0,class:"error_message"},be={class:"form_item"},ye={key:0,class:"error_message"},Be={class:"form_item"},he={key:0,class:"error_message"},we={class:"form_submit_bar"},Ue={class:"word_limit"},Ee={key:0,class:"limit_warning"},y=2e3,xe={__name:"SubmitView",setup(Ie){const m=P(),t=_({title:"",content:"",name:m.info?.name||"",email:m.info?.userName||"",language:"",coverImage:null,coverImageUrl:""}),l=_({title:"",content:"",name:"",email:"",language:"",coverImage:""}),i=_([]),x=_(!1),I=_(null),B=_(null),C=_(null),N=E(()=>t.value.content.length),h=E(()=>N.value>y),R=o=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o),b=o=>{l.value[o]=""},Q=o=>{try{const e=o?.[0].file;if(!e){p.error("No file selected");return}if(!e.type||!/^image\//.test(e.type)){p.error("You can only upload image files!");return}if(!e.size||e.size/1024/1024>=2){p.error("Image must be smaller than 2MB!");return}C.value=null,i.value=o}catch{p.error("Failed to process the selected file")}},M=async o=>{C.value=o.response,B.value?.close(),k()},J=o=>{throw B.value?.close(),p.error("Failed to upload image"),o},F=()=>(i.value[0]?.url&&URL.revokeObjectURL(i.value[0].url),t.value.coverImage=null,t.value.coverImageUrl="",i.value=[],!0),L=()=>{let o=!0;return t.value.title.trim()?l.value.title="":(l.value.title="Title is required",o=!1),t.value.content.trim()?t.value.content.length>y?(l.value.content=`Content exceeds the ${y} character limit`,o=!1):l.value.content="":(l.value.content="Content is required",o=!1),t.value.name.trim()?l.value.name="":(l.value.name="Name is required",o=!1),t.value.email.trim()?R(t.value.email)?l.value.email="":(l.value.email="Please enter a valid email address",o=!1):(l.value.email="Email is required",o=!1),t.value.language?l.value.language="":(l.value.language="Please select a language",o=!1),i.value.length?l.value.coverImage="":(l.value.coverImage="Please upload a cover image",o=!1),o},K=async()=>{if(L())try{x.value=!0,B.value=p.loading({content:"Uploading your poem, please wait...",duration:0}),C.value?k():I.value.submit()}catch(o){B.value?.close(),p.error(`Submission failed: ${o.message}`)}},k=async()=>{const o={accessUrl:C.value.accessUrl,authorId:m.info.userId,authorName:t.value.name,content:t.value.content,imageUrl:C.value.fileName,title:t.value.title,email:t.value.email,language:t.value.language},e=await Z(o);e.code===0&&(p.success(e.msg),x.value=!1,j())};function j(){t.value={title:"",content:"",name:m.info.name,email:m.info.userName,language:"",coverImage:null,coverImageUrl:""},C.value=null,i.value=[]}W(()=>{m.info&&(t.value.name=m.info?.name||"",t.value.email=m.info?.userName||"")});const D=E(()=>"/backendAPI/sys/oss/s3/upload");return(o,e)=>{const w=d("a-input"),O=d("a-textarea"),z=d("icon-delete"),U=d("a-button"),G=d("icon-upload"),T=d("a-upload"),f=d("a-option"),H=d("a-select");return g(),v("div",ee,[a("main",ae,[a("section",le,[a("div",te,[e[28]||(e[28]=a("div",{class:"text_Block"},[a("div",{class:"text size1"},"Every poem deserves to be seen"),a("div",{class:"text size2"},"Let your poems embark on a journey")],-1)),a("section",oe,[e[27]||(e[27]=a("div",{class:"title"},[a("img",{src:$,alt:""}),a("div",null,"Fill in the poetry information")],-1)),a("div",se,[a("div",ne,[a("div",re,[e[11]||(e[11]=a("div",{class:"form_label"},"Title",-1)),s(w,{modelValue:t.value.title,"onUpdate:modelValue":e[0]||(e[0]=n=>t.value.title=n),placeholder:"Enter your poem title",error:!!l.value.title,onChange:e[1]||(e[1]=n=>b("title"))},null,8,["modelValue","error"]),l.value.title?(g(),v("div",ie,c(l.value.title),1)):A("",!0)]),a("div",ue,[e[12]||(e[12]=a("div",{class:"form_label"},"Content",-1)),s(O,{modelValue:t.value.content,"onUpdate:modelValue":e[2]||(e[2]=n=>t.value.content=n),placeholder:"Enter your poem content","auto-size":{minRows:20,maxRows:40},error:!!l.value.content||h.value,onChange:e[3]||(e[3]=n=>b("content"))},null,8,["modelValue","error"]),l.value.content?(g(),v("div",me,c(l.value.content),1)):A("",!0)])]),a("div",ve,[a("div",de,[e[15]||(e[15]=a("div",{class:"form_label"},"Cover Image",-1)),a("div",{class:X(["cover_upload_container",{"has-error":!!l.value.coverImage}])},[V(a("div",ce,[a("img",{src:i.value[0]?i.value[0].url:"",alt:"Cover preview",class:"cover-preview"},null,8,ge),s(U,{class:"remove-button",status:"danger",shape:"circle",onClick:F},{icon:r(()=>[s(z)]),_:1})],512),[[S,i.value.length>0]]),V(a("div",pe,[s(T,{ref_key:"uploadRef",ref:I,"file-list":i.value,"list-type":"picture-card","image-preview":"",limit:1,action:D.value,accept:"image/*","auto-upload":!1,"show-file-list":!1,onChange:Q,onSuccess:M,onError:J,onProgress:e[4]||(e[4]=n=>console.log("Upload progress:",n))},{"upload-button":r(()=>[a("div",fe,[s(U,{type:"primary",class:"upload-button"},{icon:r(()=>[s(G)]),default:r(()=>[e[13]||(e[13]=u(" Select Cover Image "))]),_:1,__:[13]})])]),_:1},8,["file-list","action"])],512),[[S,i.value.length===0]]),e[14]||(e[14]=a("div",{class:"upload-tip"},"Max file size: 2MB",-1))],2),l.value.coverImage?(g(),v("div",_e,c(l.value.coverImage),1)):A("",!0)]),a("div",Ae,[e[16]||(e[16]=a("div",{class:"form_label"},"Name",-1)),s(w,{modelValue:t.value.name,"onUpdate:modelValue":e[5]||(e[5]=n=>t.value.name=n),placeholder:"Enter your name",error:!!l.value.name,onChange:e[6]||(e[6]=n=>b("name"))},null,8,["modelValue","error"]),l.value.name?(g(),v("div",Ce,c(l.value.name),1)):A("",!0)]),a("div",be,[e[17]||(e[17]=a("div",{class:"form_label"},"Email",-1)),s(w,{modelValue:t.value.email,"onUpdate:modelValue":e[7]||(e[7]=n=>t.value.email=n),placeholder:"Enter your email",error:!!l.value.email,onChange:e[8]||(e[8]=n=>b("email"))},null,8,["modelValue","error"]),l.value.email?(g(),v("div",ye,c(l.value.email),1)):A("",!0)]),a("div",Be,[e[25]||(e[25]=a("div",{class:"form_label"},"Language",-1)),s(H,{modelValue:t.value.language,"onUpdate:modelValue":e[9]||(e[9]=n=>t.value.language=n),placeholder:"Select language",error:!!l.value.language,onChange:e[10]||(e[10]=n=>b("language"))},{default:r(()=>[s(f,{value:"english"},{default:r(()=>e[18]||(e[18]=[u("English")])),_:1,__:[18]}),s(f,{value:"chinese"},{default:r(()=>e[19]||(e[19]=[u("Chinese")])),_:1,__:[19]}),s(f,{value:"spanish"},{default:r(()=>e[20]||(e[20]=[u("Spanish")])),_:1,__:[20]}),s(f,{value:"french"},{default:r(()=>e[21]||(e[21]=[u("French")])),_:1,__:[21]}),s(f,{value:"german"},{default:r(()=>e[22]||(e[22]=[u("German")])),_:1,__:[22]}),s(f,{value:"japanese"},{default:r(()=>e[23]||(e[23]=[u("Japanese")])),_:1,__:[23]}),s(f,{value:"korean"},{default:r(()=>e[24]||(e[24]=[u("Korean")])),_:1,__:[24]})]),_:1},8,["modelValue","error"]),l.value.language?(g(),v("div",he,c(l.value.language),1)):A("",!0)])])]),a("div",we,[a("div",Ue,[u(" Word limit: "+c(y)+" characters "),h.value?(g(),v("span",Ee," ("+c(N.value-y)+" characters over limit) ",1)):A("",!0)]),s(U,{type:"primary",class:"submit_button",onClick:K,disabled:h.value},{default:r(()=>e[26]||(e[26]=[a("div",{class:"pic_wrapper"},[a("img",{src:Y,alt:""})],-1),u(" Submit ")])),_:1,__:[26]},8,["disabled"])])])])])])])}}},ke=q(xe,[["__scopeId","data-v-b5776838"]]);export{ke as default};
